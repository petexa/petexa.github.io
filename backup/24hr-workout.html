<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="24 Hour Workout Schedule - November 22-23rd 2025 in support of Ender's Touch charity"
    />
    <title>24 Hour Workout Schedule - IDFit</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bai+Jamjuree:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

    <style>
      /*
    Colors adjusted to match the original site:
    - page background: #1a1a1a (dark)
    - panels: gradient #2a2a2a -> #1a1a1a
    - accent / blue: #3366ff
    - muted/content text: #e0e0e0
  */
      :root {
        --page-bg-top: #000000;
        --page-bg-bottom: #000000;
        --panel-from: #2a2a2a;
        --panel-to: #1a1a1a;
        --accent: #3366ff;
        --card-text: #e0e0e0;
        --card-bg: rgba(255, 255, 255, 0.02); /* subtle light overlay */
        --focus: 3px solid rgba(51, 102, 255, 0.14);
        --active-glow: rgba(0, 255, 0, 0.4); /* green glow for active */
        --inactive-glow: rgba(255, 255, 255, 0.15); /* white glow for others */
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        /* use Montserrat from Google Fonts with sensible fallbacks */
        font-family:
          'Montserrat',
          system-ui,
          -apple-system,
          'Segoe UI',
          Roboto,
          Arial,
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: linear-gradient(180deg, var(--page-bg-top), var(--page-bg-bottom));
        color: var(--card-text);
        padding: 28px;
      }

      /* Top header with back link, page title and centered logos */
      header.topbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        max-width: 980px;
        margin: 0 auto 18px;
      }
      .top-left {
        flex: 0 0 auto;
      }
      .top-center {
        flex: 1 1 auto;
        text-align: center;
        color: var(--card-text);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
      }
      .top-right {
        flex: 0 0 auto;
        opacity: 0; /* keep layout but hide right area */
      }

      .back-link {
        color: var(--card-text);
        text-decoration: none;
        font-weight: 600;
        display: inline-flex;
        gap: 8px;
        align-items: center;
      }
      .back-link i {
        color: var(--accent);
      }

      .page-title {
        margin: 0;
        font-size: 1.15rem;
        letter-spacing: 0.4px;
        font-weight: 600;
      }
      .page-sub {
        margin: 4px 0 0;
        font-size: 0.88rem;
        opacity: 0.9;
        color: var(--card-text);
      }

      /* IDFit logo (now shown in header center) */
      .idfit-top {
        width: 220px;
        height: auto;
        display: block;
        object-fit: contain;
        border-radius: 6px;
        filter: drop-shadow(0 8px 24px rgba(0, 0, 0, 0.6));
        background: #000;
        padding: 6px;
      }

      /* Charity logo centered under title */
      .charity-top {
        display: inline-block;
        width: 120px;
        height: 120px;
        border-radius: 8px;
        overflow: hidden;
        border: 2px solid rgba(255, 255, 255, 0.04);
        background: transparent;
        margin-top: 6px;
      }
      .charity-top img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }
      .charity-top:focus,
      .charity-top:hover {
        outline: none;
        box-shadow: 0 8px 20px rgba(51, 102, 255, 0.06);
        transform: translateY(-2px);
      }

      /* Two-column time-block list */
      .timeblocks {
        max-width: 1400px;
        margin: 18px auto 40px;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 18px;
      }

      /* Card look matches original 'workout-card' look:
     gradient background, rounded corners, blue border accent */
      .block {
        background: linear-gradient(135deg, var(--panel-from) 0%, var(--panel-to) 100%);
        border-radius: 16px;
        padding: 18px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
        border: 2px solid rgba(51, 102, 255, 0.04);
        color: var(--card-text);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        gap: 12px;
        transition:
          transform 0.15s ease,
          box-shadow 0.15s ease,
          box-shadow 0.15s;
      }
      .block:focus-within,
      .block:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 36px rgba(0, 0, 0, 0.6);
      }

      .time-box {
        background: var(--accent);
        color: #fff;
        border-radius: 8px;
        padding: 16px 18px;
        width: 100%;
        max-width: 520px;
        margin: 0 auto;
        text-align: center;
        box-shadow: inset 0 -6px 0 rgba(0, 0, 0, 0.06);
      }
      /* ensure titles use the heavier weight for contrast */
      .time-box .title {
        font-weight: 700;
        font-size: 1.05rem;
        margin: 0;
        text-transform: none;
      }

      .workout {
        max-width: 760px;
        margin: 0 auto;
        color: var(--card-text);
        line-height: 1.6;
      }
      .workout ul {
        margin: 8px 0 0;
        padding-left: 18px;
      }
      .workout li {
        margin: 6px 0;
      }

      /* Active block styling uses green glow */
      .block.active {
        box-shadow:
          0 0 20px 8px var(--active-glow),
          0 12px 36px rgba(0, 0, 0, 0.6);
        border-color: #00ff00;
      }

      /* Non-active blocks get white glow */
      .block:not(.active) {
        box-shadow:
          0 0 10px 4px var(--inactive-glow),
          0 8px 24px rgba(0, 0, 0, 0.6);
      }

      /* small screens */
      @media (max-width: 840px) {
        header.topbar {
          flex-direction: column;
          align-items: stretch;
          gap: 8px;
          padding: 0 8px;
        }
        .top-center {
          text-align: center;
          padding-left: 0;
        }
        .idfit-top {
          width: 180px;
        }
        .charity-top {
          width: 100px;
          height: 100px;
        }
        .top-right {
          display: none;
        }
        .timeblocks {
          grid-template-columns: 1fr;
        }
      }
      @media (max-width: 640px) {
        body {
          padding: 16px;
        }
        .time-box {
          padding: 12px 14px;
        }
        .block {
          padding: 12px;
          border-radius: 12px;
        }
        .charity-top {
          width: 80px;
          height: 80px;
        }
      }

      /* Style for "Proudly Supporting" text */
      .proudly-supporting {
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--card-text);
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      /* accessibility focus */
      a:focus,
      button:focus,
      .block:focus {
        outline: var(--focus);
        outline-offset: 3px;
      }

      /* screen-reader only */
      .sr-only {
        position: absolute;
        left: -9999px;
        top: auto;
        width: 1px;
        height: 1px;
        overflow: hidden;
      }

      /* Utility classes for consistent styling */
      .workout-note {
        font-style: italic;
        color: #cfdff9;
        margin-top: 6px;
      }

      /* Countdown tracker styles */
      .countdown-tracker {
        max-width: 980px;
        margin: 0 auto 32px;
        background: linear-gradient(135deg, var(--panel-from) 0%, var(--panel-to) 100%);
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
        border: 2px solid var(--accent);
      }

      .tracker-title {
        text-align: center;
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--card-text);
        margin: 0 0 20px;
        letter-spacing: 0.5px;
      }

      .tracker-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
      }

      .stat-item {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 12px;
        padding: 18px;
        text-align: center;
        border: 1px solid rgba(255, 255, 255, 0.08);
        transition: transform 0.2s ease;
      }

      .stat-item:hover {
        transform: translateY(-2px);
        background: rgba(255, 255, 255, 0.05);
      }

      .stat-emoji {
        font-size: 2.5rem;
        display: block;
        margin-bottom: 8px;
      }

      .stat-label {
        font-size: 0.85rem;
        color: rgba(224, 224, 224, 0.7);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 6px;
        font-weight: 600;
      }

      .stat-value {
        font-size: 2.2rem;
        font-weight: 700;
        color: var(--card-text);
        line-height: 1;
      }

      .stat-subtext {
        font-size: 0.9rem;
        color: rgba(224, 224, 224, 0.6);
        margin-top: 4px;
      }

      /* Session number badge */
      .session-badge {
        display: inline-block;
        background: var(--accent);
        color: #fff;
        font-size: 0.85rem;
        font-weight: 700;
        padding: 6px 12px;
        border-radius: 20px;
        margin-bottom: 8px;
        box-shadow: 0 2px 8px rgba(51, 102, 255, 0.3);
      }

      /* Mobile responsiveness for tracker */
      @media (max-width: 640px) {
        .countdown-tracker {
          padding: 16px;
          margin-bottom: 24px;
        }

        .tracker-title {
          font-size: 1.1rem;
          margin-bottom: 16px;
        }

        .tracker-stats {
          grid-template-columns: 1fr;
          gap: 12px;
        }

        .stat-item {
          padding: 14px;
        }

        .stat-emoji {
          font-size: 2rem;
        }

        .stat-value {
          font-size: 1.8rem;
        }

        .session-badge {
          font-size: 0.75rem;
          padding: 4px 10px;
        }
      }

      footer {
        text-align: center;
        color: #cfe6ff;
        margin-top: 24px;
      }

      footer a {
        color: #fff;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <!-- Top bar: back link (left), centered area contains IDFit logo, title and centered charity logo -->
    <header class="topbar" role="banner" aria-label="Page header">
      <div class="top-left">
        <a class="back-link" href="index.html" title="Back to Events">
          <i class="fa-solid fa-arrow-left" aria-hidden="true"></i>
          <span class="sr-only">Back to Events</span>
        </a>
      </div>

      <div class="top-center">
        <!-- IDFit logo added back in, centered -->
        <img src="images/idfit.jpg" alt="IDFit logo" class="idfit-top" width="1024" height="585" loading="lazy" />
        <div>
          <h1 class="page-title">24 Hour Work Out</h1>
          <div class="page-sub">Current hour shown at top. When it passes it drops to the bottom.</div>
        </div>

        <!-- charity logo centered under the title -->
        <div class="proudly-supporting">Proudly Supporting</div>
        <a
          class="charity-top"
          href="https://www.gofundme.com/f/in-memory-of-our-ender-touching-the-hearts-of-other-children?attribution_id=sl%3A51fe474c-c85b-47b7-aa25-2939bbdfdd39&lang=en_GB&ts=1762633561&utm_source=cust[...]"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Donate to Ender's Touch on GoFundMe"
          title="Donate to Ender's Touch"
        >
          <img src="images/enders.png" alt="Ender's Touch charity logo" width="529" height="472" />
        </a>
      </div>

      <!-- keep a right column for layout parity (hidden visually) -->
      <div class="top-right" aria-hidden="true"></div>
    </header>

    <main id="main" role="main">
      <!-- Countdown Tracker -->
      <section class="countdown-tracker" aria-live="polite" aria-atomic="true">
        <h2 class="tracker-title">24-Hour Challenge Progress</h2>
        <div class="tracker-stats">
          <div class="stat-item">
            <span class="stat-emoji" aria-hidden="true">‚úÖ</span>
            <div class="stat-label">Completed</div>
            <div class="stat-value" id="completed-sessions">0</div>
            <div class="stat-subtext">Sessions</div>
          </div>
          <div class="stat-item">
            <span class="stat-emoji" aria-hidden="true">‚è≥</span>
            <div class="stat-label">In Progress</div>
            <div class="stat-value" id="current-session">-</div>
            <div class="stat-subtext">Current Hour</div>
          </div>
          <div class="stat-item">
            <span class="stat-emoji" aria-hidden="true">üèÅ</span>
            <div class="stat-label">Remaining</div>
            <div class="stat-value" id="remaining-sessions">24</div>
            <div class="stat-subtext">Sessions</div>
          </div>
        </div>
      </section>

      <section class="timeblocks" id="timeblocks" aria-live="polite">
        <!-- Block elements: data-start is the London-local start time (YYYY-MM-DDTHH:mm:ss)
           Titles inside the blue box are generated from those values and formatted for Europe/London.
           The small duplicated .sub elements were removed to avoid duplication. -->

        <article class="block" data-start="2025-11-22T12:00:00" aria-labelledby="b-12-13">
          <div class="time-box"><div class="title" id="b-12-13"></div></div>
          <div class="workout">
            <strong>No run 'rox:</strong>
            <p>3 rounds</p>
            <ul>
              <li>500m row</li>
              <li>500m ski</li>
              <li>100m farmer walk</li>
              <li>50m sled push</li>
              <li>50m sled pull</li>
              <li>50 wall balls</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T13:00:00" aria-labelledby="b-13-14">
          <div class="time-box"><div class="title" id="b-13-14"></div></div>
          <div class="workout">
            <strong>In groups of 2/3s</strong>
            <p>150 calories on erg*</p>
            <ul>
              <li>30 Reverse Lunge</li>
              <li>20 DB Snatch</li>
              <li>10 push up</li>
            </ul>
            <div class="workout-note">5 rounds - *-25 calories each round</div>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T14:00:00" aria-labelledby="b-14-15">
          <div class="time-box"><div class="title" id="b-14-15"></div></div>
          <div class="workout">
            <strong>40-30-20-10-20-30-40</strong>
            <ul>
              <li>Calories</li>
              <li>Step up</li>
              <li>DB Bench Press</li>
              <li>SA Push Press</li>
            </ul>
            <div class="workout-note">Time cap - 45 minutes</div>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T15:00:00" aria-labelledby="b-15-16">
          <div class="time-box"><div class="title" id="b-15-16"></div></div>
          <div class="workout">
            <strong>21-15-9</strong>
            <ul>
              <li>Deadlift</li>
              <li>Tyre flip</li>
              <li>Burpee over bar</li>
              <li>Jump Squat</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T16:00:00" aria-labelledby="b-16-17">
          <div class="time-box"><div class="title" id="b-16-17"></div></div>
          <div class="workout">
            <strong>Arm blast: 5 rounds</strong>
            <ul>
              <li>6 Chin ups</li>
              <li>8 Tricep dips</li>
              <li>10 EZ bar curl</li>
              <li>12 Hammer curl</li>
            </ul>
            <div class="workout-note">Max push ups to finish</div>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T17:00:00" aria-labelledby="b-17-18">
          <div class="time-box"><div class="title" id="b-17-18"></div></div>
          <div class="workout">
            <strong>28 minute AMRAP</strong>
            <ul>
              <li>200m row</li>
              <li>20 DB G20H</li>
              <li>200m ski</li>
              <li>10 Deadlift</li>
              <li>400m Air bike</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T18:00:00" aria-labelledby="b-18-19">
          <div class="time-box"><div class="title" id="b-18-19"></div></div>
          <div class="workout">
            <strong>Strength hour:</strong>
            <p>30 minutes to build a 3rm</p>
            <ul>
              <li>Bench Press</li>
              <li>Overhead Press</li>
              <li>Bent over Row</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T19:00:00" aria-labelledby="b-19-20">
          <div class="time-box"><div class="title" id="b-19-20"></div></div>
          <div class="workout">
            <strong>In a group:</strong>
            <p>10000m row</p>
            <div class="workout-note">Timecap: 40 minutes</div>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T20:00:00" aria-labelledby="b-20-21">
          <div class="time-box"><div class="title" id="b-20-21"></div></div>
          <div class="workout">
            <strong>In teams of 2-4:</strong>
            <ul>
              <li>100 - Devil Press</li>
              <li>200 - Wall Balls</li>
              <li>300 - Lunge</li>
              <li>400 - Push Ups</li>
              <li>500 - Squats</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T21:00:00" aria-labelledby="b-21-22">
          <div class="time-box"><div class="title" id="b-21-22"></div></div>
          <div class="workout">
            <strong>Partner YGIG</strong>
            <p>Buy in: 100 calorie ski</p>
            <p><strong>5 rounds:</strong></p>
            <ul>
              <li>10 Plate Burpee</li>
              <li>15 Slams</li>
              <li>20 Gorilla row</li>
              <li>25 Hammer curl</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T22:00:00" aria-labelledby="b-22-23">
          <div class="time-box"><div class="title" id="b-22-23"></div></div>
          <div class="workout">
            <strong>2-4-6-8-10-12</strong>
            <ul>
              <li>Deadlift</li>
              <li>Hang clean</li>
              <li>Push press</li>
            </ul>
            <div class="workout-note">Buy out: 100 calorie row</div>
          </div>
        </article>

        <article class="block" data-start="2025-11-22T23:00:00" aria-labelledby="b-23-00">
          <div class="time-box"><div class="title" id="b-23-00"></div></div>
          <div class="workout">
            <strong>Max atlas stone hold</strong>
            <p>Each second held is 1 push up, squat or burpee to complete after for partner.</p>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T00:00:00" aria-labelledby="b-00-01">
          <div class="time-box"><div class="title" id="b-00-01"></div></div>
          <div class="workout"><strong>Midnight Mile</strong></div>
        </article>

        <article class="block" data-start="2025-11-23T01:00:00" aria-labelledby="b-01-02">
          <div class="time-box"><div class="title" id="b-01-02"></div></div>
          <div class="workout">
            <strong>15 minute AMRAP:</strong>
            <ul>
              <li>10 Bench press</li>
              <li>8 Military press</li>
              <li>6 Bicep curl</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T02:00:00" aria-labelledby="b-02-03">
          <div class="time-box"><div class="title" id="b-02-03"></div></div>
          <div class="workout">
            <strong>"Core its getting late"</strong>
            <ul>
              <li>10 butterfly sit up</li>
              <li>10s plank</li>
            </ul>
            <div class="workout-note">
              +10 second/reps each round ‚Äî Go until failure
            </div>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T03:00:00" aria-labelledby="b-03-04">
          <div class="time-box"><div class="title" id="b-03-04"></div></div>
          <div class="workout">
            <ul>
              <li>Max push up in 3 minutes</li>
              <li>Max situps in 3 minutes</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T04:00:00" aria-labelledby="b-04-05">
          <div class="time-box"><div class="title" id="b-04-05"></div></div>
          <div class="workout">
            <strong>As a group</strong>
            <p>3000m ski</p>
            <p><strong>Changeover:</strong></p>
            <ul>
              <li>10 Goblet squat</li>
              <li>15 KB swing</li>
              <li>20 step up</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T05:00:00" aria-labelledby="b-05-06">
          <div class="time-box"><div class="title" id="b-05-06"></div></div>
          <div class="workout">
            <strong>Core & Coffee:</strong>
            <p>Stretch and relax ‚Äî 25 minutes Stretch</p>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T06:00:00" aria-labelledby="b-06-07">
          <div class="time-box"><div class="title" id="b-06-07"></div></div>
          <div class="workout">
            <strong>32 Minute E4MOM:</strong>
            <ul>
              <li>5 Pull/Chin up</li>
              <li>10 V-up</li>
              <li>15 Gorilla row</li>
              <li>20 KB high pull</li>
              <li>25 KB Dragthrough</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T07:00:00" aria-labelledby="b-07-08">
          <div class="time-box"><div class="title" id="b-07-08"></div></div>
          <div class="workout">
            <strong>3 rounds:</strong>
            <ul>
              <li>1km run</li>
              <li>25 thruster</li>
              <li>50 sit up</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T08:00:00" aria-labelledby="b-08-09">
          <div class="time-box"><div class="title" id="b-08-09"></div></div>
          <div class="workout">
            <strong>5 rounds:</strong>
            <ul>
              <li>25m Walking lunge</li>
              <li>25m Sled pull</li>
              <li>25m KB OH March</li>
              <li>50m Farmers carry</li>
              <li>50m Sled push</li>
            </ul>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T09:00:00" aria-labelledby="b-09-10">
          <div class="time-box"><div class="title" id="b-09-10"></div></div>
          <div class="workout">
            <strong>As a group</strong>
            <p>1000 cal combined</p>
            <p>ROW-SKI - BIKE</p>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T10:00:00" aria-labelledby="b-10-11">
          <div class="time-box"><div class="title" id="b-10-11"></div></div>
          <div class="workout">
            <strong>In pairs: 5 rounds</strong>
            <p>2000m</p>
            <p>(-400m each round)</p>
            <p>50 slams & reverse lunge</p>
            <p>(-10 per round)</p>
          </div>
        </article>

        <article class="block" data-start="2025-11-23T11:00:00" aria-labelledby="b-11-12">
          <div class="time-box"><div class="title" id="b-11-12"></div></div>
          <div class="workout">
            <ul>
              <li>25 Squat</li>
              <li>25 Lunge</li>
              <li>5km run</li>
              <li>25 Squat</li>
              <li>25 Lunge</li>
            </ul>
          </div>
        </article>
      </section>
    </main>

    <footer>
      &copy; <span id="year"></span> IDFit Events | Have an event?
      <a href="mailto:gym@petefox.co.uk">Contact us</a>
    </footer>

    <script>
      (function () {
        const pad = n => String(n).padStart(2, '0');

        // Event start time: Nov 22, 2025 at 12:00 PM (noon)
        const EVENT_START = { year: 2025, month: 11, day: 22, hour: 12, minute: 0 };
        const TOTAL_SESSIONS = 24;

        // parse "YYYY-MM-DDTHH:mm:ss" into parts
        function parseParts(s) {
          if (!s) return null;
          const m = s.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::\d{2})?$/);
          if (!m) return null;
          return {
            year: Number(m[1]),
            month: Number(m[2]),
            day: Number(m[3]),
            hour: Number(m[4]),
            minute: Number(m[5] || 0),
          };
        }

        // Calculate session number based on data-start (first session at 12pm is #1)
        function calculateSessionNumber(parts) {
          if (!parts) return null;
          
          // Calculate hours from event start
          const startDate = new Date(EVENT_START.year, EVENT_START.month - 1, EVENT_START.day, EVENT_START.hour, EVENT_START.minute);
          const sessionDate = new Date(parts.year, parts.month - 1, parts.day, parts.hour, parts.minute);
          const hoursDiff = Math.floor((sessionDate - startDate) / (1000 * 60 * 60));
          
          return hoursDiff + 1; // First session (12pm) is session #1
        }

        // format "HH:MM - HH:MM" using the parts (treated as Europe/London wallclock)
        function formatRangeFromParts(p) {
          const startH = pad(p.hour);
          const startM = pad(p.minute);
          const endHour = (p.hour + 1) % 24;
          const endH = pad(endHour);
          return `${startH}:${startM} - ${endH}:${startM}`;
        }

        // get now in Europe/London as parts object
        function nowInLondonParts() {
          const now = new Date();
          const f = new Intl.DateTimeFormat('en-GB', {
            timeZone: 'Europe/London',
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            hour12: false,
          });
          const parts = f.formatToParts(now);
          const map = {};
          parts.forEach(p => {
            if (p.type !== 'literal') map[p.type] = p.value;
          });
          return {
            year: Number(map.year),
            month: Number(map.month),
            day: Number(map.day),
            hour: Number(map.hour),
            minute: Number(map.minute),
          };
        }

        // helper to make sortable key from parts
        function keyFromParts(p) {
          return `${p.year}${pad(p.month)}${pad(p.day)}${pad(p.hour)}`;
        }

        // check if now in London matches the block start hour
        function isNowActiveForParts(startParts, nowParts) {
          return (
            startParts &&
            startParts.year === nowParts.year &&
            startParts.month === nowParts.month &&
            startParts.day === nowParts.day &&
            startParts.hour === nowParts.hour
          );
        }

        // Update countdown tracker
        function updateCountdownTracker() {
          const nowParts = nowInLondonParts();
          const blocks = document.querySelectorAll('.block');
          
          let completedCount = 0;
          let currentSessionNum = null;
          let remainingCount = TOTAL_SESSIONS;

          blocks.forEach(b => {
            const s = b.getAttribute('data-start');
            const parts = parseParts(s);
            
            if (parts) {
              const sessionNum = calculateSessionNumber(parts);
              const k = keyFromParts(parts);
              const nowKey = `${nowParts.year}${pad(nowParts.month)}${pad(nowParts.day)}${pad(nowParts.hour)}`;
              
              if (isNowActiveForParts(parts, nowParts)) {
                currentSessionNum = sessionNum;
              } else if (k < nowKey) {
                completedCount++;
              }
            }
          });

          remainingCount = TOTAL_SESSIONS - completedCount - (currentSessionNum ? 1 : 0);

          // Update DOM
          const completedEl = document.getElementById('completed-sessions');
          const currentEl = document.getElementById('current-session');
          const remainingEl = document.getElementById('remaining-sessions');

          if (completedEl) completedEl.textContent = completedCount;
          if (currentEl) currentEl.textContent = currentSessionNum ? `#${currentSessionNum}` : '-';
          if (remainingEl) remainingEl.textContent = remainingCount;
        }

        // populate the blue title boxes and add session badges
        function populateTitles() {
          document.querySelectorAll('.block').forEach(block => {
            const s = block.getAttribute('data-start');
            const parts = parseParts(s);
            const titleEl = block.querySelector('.time-box .title');
            const workoutEl = block.querySelector('.workout');
            
            if (parts && titleEl) {
              titleEl.textContent = formatRangeFromParts(parts);
              block.setAttribute('aria-label', `Time block ${titleEl.textContent}`);
              
              // Add session number badge if not already added
              const sessionNum = calculateSessionNumber(parts);
              if (sessionNum && workoutEl && !workoutEl.querySelector('.session-badge')) {
                const badge = document.createElement('div');
                badge.className = 'session-badge';
                badge.textContent = `Session #${sessionNum}`;
                badge.setAttribute('aria-label', `Session number ${sessionNum}`);
                workoutEl.insertBefore(badge, workoutEl.firstChild);
              }
            }
          });
        }

        // reorder blocks: active first, upcoming next (ascending), past last (ascending)
        function reorderBlocks() {
          const container = document.getElementById('timeblocks');
          const blocks = Array.from(container.querySelectorAll('.block'));
          const nowParts = nowInLondonParts();

          const active = [];
          const upcoming = [];
          const past = [];

          blocks.forEach(b => {
            const s = b.getAttribute('data-start');
            const parts = parseParts(s);
            b.classList.remove('active');

            if (parts && isNowActiveForParts(parts, nowParts)) {
              active.push({ b, key: keyFromParts(parts) });
            } else if (parts) {
              const k = keyFromParts(parts);
              const nowKey = `${nowParts.year}${pad(nowParts.month)}${pad(nowParts.day)}${pad(nowParts.hour)}`;
              if (k > nowKey) upcoming.push({ b, key: k });
              else past.push({ b, key: k });
            } else {
              upcoming.push({ b, key: '9999999999' });
            }
          });

          upcoming.sort((a, c) => a.key.localeCompare(c.key));
          past.sort((a, c) => a.key.localeCompare(c.key));
          active.sort((a, c) => a.key.localeCompare(c.key));

          const frag = document.createDocumentFragment();
          active.forEach(item => {
            item.b.classList.add('active');
            frag.appendChild(item.b);
          });
          upcoming.forEach(item => frag.appendChild(item.b));
          past.forEach(item => frag.appendChild(item.b));

          container.innerHTML = '';
          container.appendChild(frag);
        }

        // initialize
        populateTitles();
        reorderBlocks();
        updateCountdownTracker();

        // run periodically (60s for countdown, 15s for reordering)
        setInterval(() => {
          updateCountdownTracker();
        }, 60000); // Update countdown every minute

        setInterval(() => {
          populateTitles(); // safe no-op after first run but cheap
          reorderBlocks();
        }, 15000);

        // set year
        const yearEl = document.getElementById('year');
        if (yearEl) yearEl.textContent = new Date().getFullYear();
      })();
    </script>
  </body>
</html>

